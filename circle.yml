machine:
  services:
    - docker

dependencies:
  override:
    - docker build --build-arg EMAIL_RECIPIENT="$EMAIL_RECIPIENT" -t fredhutch/docker-ls2:$CIRCLE_SHA1 .
    #- curl -LO https://github.com/rancher/rancher-compose/releases/download/v0.12.5/rancher-compose-linux-amd64-v0.12.5.tar.gz
    #- tar zxf rancher-compose-linux-amd64-v0.12.5.tar.gz


    # - echo current directory is $(pwd)
    - ls -lR

test:
  override:
    - docker run --rm fredhutch/docker-ls2:$CIRCLE_SHA1 module avail

#deployment:
  #master:
    #branch: master
    #commands:
      #- docker tag $DOCKER_HUB_HOST/$DOCKER_USER/storage-hotspots:$CIRCLE_SHA1 $DOCKER_HUB_HOST/$DOCKER_USER/storage-hotspots:latest
      # - echo user is $DOCKER_USER pass is $DOCKER_PASS host is $DOCKER_HUB_HOST
      #- docker login -e fredhutch@fhcrc.org -u $DOCKER_USER -p "$DOCKER_PASS" $DOCKER_HUB_HOST && docker push $DOCKER_HUB_HOST/$DOCKER_USER/storage-hotspots:latest
      # - sleep 10
      # - echo current directory _2_ is $(pwd)
      #- rancher-compose-v0.12.5/rancher-compose --project-name storage-hotspots --url https://ponderosa.fhcrc.org/v1/projects/1a38/stacks/1st28  --access-key $RANCHERAPI_ACCESSKEY --secret-key $RANCHERAPI_SECRETKEY up -d --pull --force-upgrade --confirm-upgrade storage-hotspots
